# Canonical Feature Flag Registry
# Single source of truth for all feature flags
# Generated types: shared/generated/flag-types.ts
# Last updated: 2026-01-22 (Epic G consolidation)

schema_version: '1.0'

# Flag naming convention: snake_case
# All flags should have: default, description, owner, risk, exposeToClient

flags:
  # ============================================
  # FOUNDATION FLAGS (Phase 1)
  # ============================================

  enable_new_ia:
    default: false
    description: '5-route navigation (Overview, Portfolio, Model, Operate, Report)'
    owner: 'gp-team'
    risk: low
    exposeToClient: true
    environments:
      development: true
      staging: false
      production: false
    dependencies: []
    expiresAt: null
    aliases: ['NEW_IA', 'new_ia'] # Legacy names for migration

  enable_kpi_selectors:
    default: false
    description: 'KPI selector system for metrics dashboard'
    owner: 'gp-team'
    risk: low
    exposeToClient: true
    environments:
      development: true
      staging: false
      production: false
    dependencies: ['enable_new_ia']
    expiresAt: null
    aliases: ['ENABLE_SELECTOR_KPIS']

  enable_brand_tokens:
    default: false
    description: 'Press On Ventures brand token system'
    owner: 'design'
    risk: low
    exposeToClient: true
    environments:
      development: true
      staging: true
      production: true
    dependencies: []
    expiresAt: null

  # ============================================
  # BUILD FLAGS (Phase 2)
  # ============================================

  enable_modeling_wizard:
    default: false
    description: '7-step modeling wizard'
    owner: 'gp-team'
    risk: medium
    exposeToClient: true
    environments:
      development: true
      staging: false
      production: false
    dependencies: ['enable_new_ia', 'enable_kpi_selectors']
    expiresAt: null
    aliases: ['ENABLE_MODELING_WIZARD']

  enable_operations_hub:
    default: false
    description: 'Capital calls and distributions hub'
    owner: 'gp-team'
    risk: medium
    exposeToClient: true
    environments:
      development: true
      staging: false
      production: false
    dependencies: ['enable_new_ia', 'enable_kpi_selectors']
    expiresAt: null
    aliases: ['ENABLE_OPERATIONS_HUB']

  enable_lp_reporting:
    default: false
    description: 'LP reporting dashboard'
    owner: 'gp-team'
    risk: medium
    exposeToClient: true
    environments:
      development: true
      staging: false
      production: false
    dependencies: ['enable_kpi_selectors', 'enable_operations_hub']
    expiresAt: null
    aliases: ['ENABLE_LP_REPORTING']

  enable_reserve_engine:
    default: false
    description: 'Deterministic reserve allocation engine'
    owner: 'analytics'
    risk: medium
    exposeToClient: true
    environments:
      development: true
      staging: false
      production: false
    dependencies: ['enable_kpi_selectors']
    expiresAt: null

  # ============================================
  # ENGINE FLAGS
  # ============================================

  ts_reserves:
    default: true
    description: 'TypeScript reserves calculation engine'
    owner: 'analytics'
    risk: low
    exposeToClient: true
    environments:
      development: true
      staging: true
      production: true
    dependencies: []
    expiresAt: null
    rolloutPercentage: 100

  wasm_reserves:
    default: false
    description: 'WebAssembly reserves calculation engine (experimental)'
    owner: 'analytics'
    risk: high
    exposeToClient: true
    environments:
      development: false
      staging: false
      production: false
    dependencies: []
    expiresAt: null
    rolloutPercentage: 0

  shadow_compare:
    default: false
    description: 'Shadow comparison between TS and WASM engines'
    owner: 'analytics'
    risk: low
    exposeToClient: true
    environments:
      development: false
      staging: false
      production: false
    dependencies: ['ts_reserves', 'wasm_reserves']
    expiresAt: null
    rolloutPercentage: 0

  # ============================================
  # FEATURE FLAGS
  # ============================================

  reserves_v11:
    default: true
    description: 'Reserves v1.1 calculation improvements'
    owner: 'analytics'
    risk: medium
    exposeToClient: true
    environments:
      development: true
      staging: true
      production: true
    dependencies: []
    expiresAt: null

  remain_pass:
    default: true
    description: 'Remaining pass calculation'
    owner: 'analytics'
    risk: low
    exposeToClient: true
    environments:
      development: true
      staging: true
      production: true
    dependencies: []
    expiresAt: null

  stage_based_caps:
    default: true
    description: 'Stage-based capital allocation caps'
    owner: 'analytics'
    risk: low
    exposeToClient: true
    environments:
      development: true
      staging: true
      production: true
    dependencies: []
    expiresAt: null

  export_async:
    default: true
    description: 'Async export functionality'
    owner: 'gp-team'
    risk: low
    exposeToClient: true
    environments:
      development: true
      staging: true
      production: true
    dependencies: []
    expiresAt: null

  metrics_collection:
    default: true
    description: 'Client-side metrics collection'
    owner: 'analytics'
    risk: low
    exposeToClient: true
    environments:
      development: true
      staging: true
      production: true
    dependencies: []
    expiresAt: null

  # ============================================
  # ADMIN FLAGS (no localStorage override)
  # ============================================

  ui_catalog:
    default: false
    description: 'Admin UI component catalog'
    owner: 'design'
    risk: low
    exposeToClient: true # But no localStorage override (admin flag)
    adminOnly: true
    environments:
      development: true
      staging: false
      production: false
    dependencies: []
    expiresAt: null
    aliases: ['UI_CATALOG']

  onboarding_tour:
    default: false
    description: 'GP onboarding tour for new users'
    owner: 'gp-team'
    risk: low
    exposeToClient: true
    environments:
      development: true
      staging: false
      production: false
    dependencies: []
    expiresAt: null
    aliases: ['ONBOARDING_TOUR']

  # ============================================
  # SERVER-ONLY FLAGS
  # ============================================

  demo_mode:
    default: false
    description: 'Demo mode with sample data'
    owner: 'platform'
    risk: low
    exposeToClient: false
    environments:
      development: true
      staging: false
      production: false
    dependencies: []
    expiresAt: null

  require_auth:
    default: false
    description: 'Require authentication for API access'
    owner: 'platform'
    risk: high
    exposeToClient: false
    environments:
      development: false
      staging: true
      production: true
    dependencies: []
    expiresAt: null

  enable_faults:
    default: false
    description: 'Enable fault injection for testing'
    owner: 'platform'
    risk: high
    exposeToClient: false
    environments:
      development: true
      staging: false
      production: false
    dependencies: []
    expiresAt: null

  # ============================================
  # WIZARD STEP FLAGS
  # ============================================

  enable_wizard_step_general:
    default: false
    description: 'Wizard Step 1: General fund info'
    owner: 'gp-team'
    risk: low
    exposeToClient: true
    environments:
      development: true
      staging: false
      production: false
    dependencies: ['enable_modeling_wizard']
    expiresAt: null

  enable_wizard_step_sizing:
    default: false
    description: 'Wizard Step 2: Fund sizing'
    owner: 'gp-team'
    risk: low
    exposeToClient: true
    environments:
      development: true
      staging: false
      production: false
    dependencies: ['enable_wizard_step_general']
    expiresAt: null

  enable_wizard_step_pacing:
    default: false
    description: 'Wizard Step 3: Pacing and deployment'
    owner: 'gp-team'
    risk: low
    exposeToClient: true
    environments:
      development: true
      staging: false
      production: false
    dependencies: ['enable_wizard_step_sizing']
    expiresAt: null

  enable_wizard_step_reserves:
    default: false
    description: 'Wizard Step 4: Reserve allocation'
    owner: 'gp-team'
    risk: medium
    exposeToClient: true
    environments:
      development: true
      staging: false
      production: false
    dependencies: ['enable_wizard_step_pacing']
    expiresAt: null

  enable_wizard_step_fees:
    default: false
    description: 'Wizard Step 5: Fee structure'
    owner: 'gp-team'
    risk: medium
    exposeToClient: true
    environments:
      development: true
      staging: false
      production: false
    dependencies: ['enable_wizard_step_reserves']
    expiresAt: null

  enable_wizard_step_waterfall:
    default: false
    description: 'Wizard Step 6: Waterfall distribution'
    owner: 'gp-team'
    risk: medium
    exposeToClient: true
    environments:
      development: true
      staging: false
      production: false
    dependencies: ['enable_wizard_step_fees']
    expiresAt: null

  enable_wizard_step_results:
    default: false
    description: 'Wizard Step 7: Results summary'
    owner: 'gp-team'
    risk: low
    exposeToClient: true
    environments:
      development: true
      staging: false
      production: false
    dependencies: ['enable_wizard_step_waterfall']
    expiresAt: null

# ============================================
# DEPRECATED FLAGS (to be removed)
# ============================================
deprecated: []
