
> rest-express@1.3.2 check:server
> tsc -p tsconfig.server.json --noEmit

client/src/core/pacing/PacingEngine.ts(67,20): error TS18048: 'adjustment' is possibly 'undefined'.
client/src/core/pacing/PacingEngine.ts(69,20): error TS18048: 'adjustment' is possibly 'undefined'.
client/src/core/pacing/PacingEngine.ts(71,20): error TS18048: 'adjustment' is possibly 'undefined'.
client/src/core/reserves/DeterministicReserveEngine.ts(260,58): error TS18048: 'calc' is possibly 'undefined'.
client/src/core/reserves/DeterministicReserveEngine.ts(274,9): error TS2345: Argument of type 'MOICCalculation | undefined' is not assignable to parameter of type 'MOICCalculation'.
  Type 'undefined' is not assignable to type 'MOICCalculation'.
client/src/core/reserves/DeterministicReserveEngine.ts(283,11): error TS2345: Argument of type 'MOICCalculation | undefined' is not assignable to parameter of type 'MOICCalculation'.
  Type 'undefined' is not assignable to type 'MOICCalculation'.
client/src/lib/__tests__/type-guards.spec.ts(307,12): error TS2532: Object is possibly 'undefined'.
client/src/lib/capital-calculations.ts(127,24): error TS2532: Object is possibly 'undefined'.
client/src/lib/capital-calculations.ts(193,26): error TS2532: Object is possibly 'undefined'.
client/src/lib/capital-first.ts(16,48): error TS2322: Type 'StageKey | undefined' is not assignable to type 'StageKey | null'.
  Type 'undefined' is not assignable to type 'StageKey | null'.
client/src/lib/demo-data.ts(468,3): error TS2322: Type 'DemoScenario | undefined' is not assignable to type 'DemoScenario'.
  Type 'undefined' is not assignable to type 'DemoScenario'.
client/src/lib/fund-calc.ts(273,9): error TS2322: Type '"failure" | "acquired" | "ipo" | "secondary" | undefined' is not assignable to type '"failure" | "acquired" | "ipo" | "secondary"'.
  Type 'undefined' is not assignable to type '"failure" | "acquired" | "ipo" | "secondary"'.
client/src/lib/fund-calc.ts(459,3): error TS2322: Type 'Decimal | undefined' is not assignable to type 'Decimal'.
  Type 'undefined' is not assignable to type 'Decimal'.
client/src/lib/inflight.ts(38,29): error TS2322: Type 'AbortSignal | undefined' is not assignable to type 'AbortSignal'.
  Type 'undefined' is not assignable to type 'AbortSignal'.
client/src/lib/nav.ts(172,23): error TS2532: Object is possibly 'undefined'.
client/src/lib/path-utils.ts(84,35): error TS2345: Argument of type 'string | undefined' is not assignable to parameter of type 'string'.
  Type 'undefined' is not assignable to type 'string'.
client/src/lib/path-utils.ts(87,21): error TS2538: Type 'undefined' cannot be used as an index type.
client/src/lib/path-utils.ts(87,47): error TS2538: Type 'undefined' cannot be used as an index type.
client/src/lib/path-utils.ts(88,12): error TS2538: Type 'undefined' cannot be used as an index type.
client/src/lib/path-utils.ts(89,53): error TS2538: Type 'undefined' cannot be used as an index type.
client/src/lib/path-utils.ts(91,12): error TS2538: Type 'undefined' cannot be used as an index type.
client/src/lib/path-utils.ts(92,53): error TS2538: Type 'undefined' cannot be used as an index type.
client/src/lib/path-utils.ts(94,12): error TS2538: Type 'undefined' cannot be used as an index type.
client/src/lib/path-utils.ts(97,17): error TS2538: Type 'undefined' cannot be used as an index type.
client/src/lib/path-utils.ts(102,8): error TS2538: Type 'undefined' cannot be used as an index type.
client/src/lib/path-utils.ts(181,17): error TS2538: Type 'undefined' cannot be used as an index type.
client/src/lib/path-utils.ts(188,17): error TS2538: Type 'undefined' cannot be used as an index type.
client/src/lib/rollout-orchestrator.ts(291,45): error TS2345: Argument of type 'RolloutMetrics | undefined' is not assignable to parameter of type 'RolloutMetrics'.
  Type 'undefined' is not assignable to type 'RolloutMetrics'.
client/src/lib/schema-adapter.ts(118,32): error TS2532: Object is possibly 'undefined'.
client/src/lib/validation-helpers.ts(92,5): error TS2322: Type 'string | undefined' is not assignable to type 'string'.
  Type 'undefined' is not assignable to type 'string'.
client/src/lib/validation-helpers.ts(95,3): error TS2322: Type 'string | undefined' is not assignable to type 'string'.
  Type 'undefined' is not assignable to type 'string'.
client/src/lib/validation.ts(60,27): error TS2538: Type 'undefined' cannot be used as an index type.
client/src/lib/validation.ts(63,12): error TS2322: Type 'string | undefined' is not assignable to type 'string'.
  Type 'undefined' is not assignable to type 'string'.
client/src/lib/wizard-calculations.ts(9,44): error TS6307: File 'c:/dev/Updog_restore/client/src/machines/modeling-wizard.machine.ts' is not listed within the file list of project 'c:/dev/Updog_restore/tsconfig.server.json'. Projects must list all files or use an 'include' pattern.
  The file is in the program because:
    Imported via '@/machines/modeling-wizard.machine' from file 'c:/dev/Updog_restore/client/src/lib/wizard-calculations.ts'
    Imported via '@/machines/modeling-wizard.machine' from file 'c:/dev/Updog_restore/client/src/lib/wizard-reserve-bridge.ts'
client/src/lib/wizard-reserve-bridge.ts(594,95): error TS6307: File 'c:/dev/Updog_restore/client/src/adapters/reserves-adapter.ts' is not listed within the file list of project 'c:/dev/Updog_restore/tsconfig.server.json'. Projects must list all files or use an 'include' pattern.
client/src/lib/wizard-schemas.ts(29,54): error TS2769: No overload matches this call.
  Overload 1 of 2, '(def: string): ZodDefault<ZodOptional<ZodString>>', gave the following error.
    Argument of type 'string | undefined' is not assignable to parameter of type 'string'.
      Type 'undefined' is not assignable to type 'string'.
  Overload 2 of 2, '(def: () => string): ZodDefault<ZodOptional<ZodString>>', gave the following error.
    Argument of type 'string | undefined' is not assignable to parameter of type '() => string'.
      Type 'undefined' is not assignable to type '() => string'.
client/src/lib/wizard-types.ts(89,3): error TS2322: Type 'string | undefined' is not assignable to type 'string'.
  Type 'undefined' is not assignable to type 'string'.
client/src/lib/xirr.ts(147,16): error TS2345: Argument of type 'string | undefined' is not assignable to parameter of type 'string'.
  Type 'undefined' is not assignable to type 'string'.
client/src/lib/xirr.ts(147,33): error TS2345: Argument of type 'string | undefined' is not assignable to parameter of type 'string'.
  Type 'undefined' is not assignable to type 'string'.
client/src/lib/xirr.ts(182,48): error TS2532: Object is possibly 'undefined'.
client/src/lib/xirr.ts(266,44): error TS2532: Object is possibly 'undefined'.
client/src/machines/modeling-wizard.machine.ts(228,44): error TS2345: Argument of type 'WizardStep | undefined' is not assignable to parameter of type 'WizardStep'.
  Type 'undefined' is not assignable to type 'WizardStep'.
client/src/machines/modeling-wizard.machine.ts(232,5): error TS2322: Type 'WizardStep | undefined' is not assignable to type 'WizardStep | null'.
  Type 'undefined' is not assignable to type 'WizardStep | null'.
client/src/machines/modeling-wizard.machine.ts(248,44): error TS2345: Argument of type 'WizardStep | undefined' is not assignable to parameter of type 'WizardStep'.
  Type 'undefined' is not assignable to type 'WizardStep'.
client/src/machines/modeling-wizard.machine.ts(252,5): error TS2322: Type 'WizardStep | undefined' is not assignable to type 'WizardStep | null'.
  Type 'undefined' is not assignable to type 'WizardStep | null'.
client/src/utils/array-safety-enhanced.ts(241,20): error TS2345: Argument of type 'T | undefined' is not assignable to parameter of type 'T'.
  'T' could be instantiated with an arbitrary type which could be unrelated to 'T | undefined'.
client/src/utils/async-iteration.ts(52,15): error TS18048: 'result' is possibly 'undefined'.
client/src/utils/async-iteration.ts(53,58): error TS18048: 'result' is possibly 'undefined'.
client/src/utils/async-iteration.ts(53,65): error TS2339: Property 'reason' does not exist on type 'PromiseSettledResult<void>'.
  Property 'reason' does not exist on type 'PromiseFulfilledResult<void>'.
client/src/utils/async-iteration.ts(67,25): error TS2345: Argument of type 'T | undefined' is not assignable to parameter of type 'T'.
  'T' could be instantiated with an arbitrary type which could be unrelated to 'T | undefined'.
client/src/utils/async-iteration.ts(98,15): error TS18048: 'result' is possibly 'undefined'.
client/src/utils/async-iteration.ts(99,71): error TS18048: 'result' is possibly 'undefined'.
client/src/utils/async-iteration.ts(99,78): error TS2339: Property 'reason' does not exist on type 'PromiseSettledResult<void>'.
  Property 'reason' does not exist on type 'PromiseFulfilledResult<void>'.
client/src/utils/async-iteration.ts(133,20): error TS2345: Argument of type 'T | undefined' is not assignable to parameter of type 'T'.
  'T' could be instantiated with an arbitrary type which could be unrelated to 'T | undefined'.
client/src/utils/async-iteration.ts(182,37): error TS2345: Argument of type 'T | undefined' is not assignable to parameter of type 'T'.
  'T' could be instantiated with an arbitrary type which could be unrelated to 'T | undefined'.
client/src/utils/async-iteration.ts(219,25): error TS2345: Argument of type 'T | undefined' is not assignable to parameter of type 'T'.
  'T' could be instantiated with an arbitrary type which could be unrelated to 'T | undefined'.
client/src/utils/async-iteration.ts(238,46): error TS2345: Argument of type 'T | undefined' is not assignable to parameter of type 'T'.
  'T' could be instantiated with an arbitrary type which could be unrelated to 'T | undefined'.
client/src/utils/async-iteration.ts(253,25): error TS2345: Argument of type 'T | undefined' is not assignable to parameter of type 'T'.
  'T' could be instantiated with an arbitrary type which could be unrelated to 'T | undefined'.
client/src/utils/async-iteration.ts(270,27): error TS2345: Argument of type 'T | undefined' is not assignable to parameter of type 'T'.
  'T' could be instantiated with an arbitrary type which could be unrelated to 'T | undefined'.
server/agents/cancel.ts(26,21): error TS2554: Expected 1 arguments, but got 0.
server/agents/cancel.ts(28,50): error TS2353: Object literal may only specify known properties, and 'runId' does not exist in type 'Error'.
server/agents/cancel.ts(52,59): error TS2353: Object literal may only specify known properties, and 'runId' does not exist in type 'Error'.
server/agents/stream.ts(88,46): error TS2345: Argument of type 'string | undefined' is not assignable to parameter of type 'string'.
  Type 'undefined' is not assignable to type 'string'.
server/agents/stream.ts(97,41): error TS2353: Object literal may only specify known properties, and 'runId' does not exist in type 'Error'.
server/app.ts(68,49): error TS4111: Property 'sendStatus' comes from an index signature, so it must be accessed with ['sendStatus'].
server/bootstrap.ts(31,61): error TS4111: Property 'DISABLE_AUTH' comes from an index signature, so it must be accessed with ['DISABLE_AUTH'].
server/compass/calculator.ts(135,5): error TS2375: Type '{ baseEV: number; evWithControl: number; finalValue: number; impliedMultiple: number; vsLastRound: { absoluteChange: number; percentChange: number; multipleChange: number; } | undefined; }' is not assignable to type '{ baseEV: number; evWithControl: number; finalValue: number; impliedMultiple: number; vsLastRound?: { absoluteChange: number; percentChange: number; multipleChange: number; }; }' with 'exactOptionalPropertyTypes: true'. Consider adding 'undefined' to the types of the target's properties.
  Types of property 'vsLastRound' are incompatible.
    Type '{ absoluteChange: number; percentChange: number; multipleChange: number; } | undefined' is not assignable to type '{ absoluteChange: number; percentChange: number; multipleChange: number; }'.
      Type 'undefined' is not assignable to type '{ absoluteChange: number; percentChange: number; multipleChange: number; }'.
server/compass/calculator.ts(179,5): error TS2322: Type 'number | undefined' is not assignable to type 'number'.
  Type 'undefined' is not assignable to type 'number'.
server/compass/calculator.ts(193,30): error TS2345: Argument of type 'number | undefined' is not assignable to parameter of type 'number'.
  Type 'undefined' is not assignable to type 'number'.
server/compass/calculator.ts(197,31): error TS2345: Argument of type 'number | undefined' is not assignable to parameter of type 'number'.
  Type 'undefined' is not assignable to type 'number'.
server/compass/routes.ts(52,9): error TS2322: Type 'string | undefined' is not assignable to type 'string'.
  Type 'undefined' is not assignable to type 'string'.
server/config.ts(12,50): error TS4111: Property 'npm_package_version' comes from an index signature, so it must be accessed with ['npm_package_version'].
server/config/swagger.ts(1,26): error TS7016: Could not find a declaration file for module 'swagger-jsdoc'. 'c:/dev/Updog_restore/node_modules/swagger-jsdoc/index.js' implicitly has an 'any' type.
  Try `npm i --save-dev @types/swagger-jsdoc` if it exists or add a new declaration (.d.ts) file containing `declare module 'swagger-jsdoc';`
server/core/market/score.ts(234,40): error TS2683: 'this' implicitly has type 'any' because it does not have a type annotation.
server/core/market/score.ts(247,45): error TS2683: 'this' implicitly has type 'any' because it does not have a type annotation.
server/core/reserves/adapter.ts(289,7): error TS2375: Type '{ recommendedReserve: number; perRound: Record<string, number> | undefined; confidence: { low: number; high: number; level: number; }; notes: string[]; }' is not assignable to type 'ReservePrediction' with 'exactOptionalPropertyTypes: true'. Consider adding 'undefined' to the types of the target's properties.
  Types of property 'perRound' are incompatible.
    Type 'Record<string, number> | undefined' is not assignable to type 'Record<string, number>'.
      Type 'undefined' is not assignable to type 'Record<string, number>'.
server/core/reserves/mlClient.ts(6,35): error TS7016: Could not find a declaration file for module 'node-fetch'. 'c:/dev/Updog_restore/node_modules/node-fetch/lib/index.js' implicitly has an 'any' type.
  Try `npm i --save-dev @types/node-fetch` if it exists or add a new declaration (.d.ts) file containing `declare module 'node-fetch';`
server/core/reserves/mlClient.ts(137,9): error TS2375: Type '{ recommendedReserve: number; perRound: Record<string, number> | undefined; confidence: { low: number; high: number; } | undefined; notes: string[]; }' is not assignable to type 'ReservePrediction' with 'exactOptionalPropertyTypes: true'. Consider adding 'undefined' to the types of the target's properties.
  Types of property 'perRound' are incompatible.
    Type 'Record<string, number> | undefined' is not assignable to type 'Record<string, number>'.
      Type 'undefined' is not assignable to type 'Record<string, number>'.
server/db/pg-circuit.ts(125,19): error TS2379: Argument of type '{ query: string; duration: number; rowCount: number; error: Error | undefined; }' is not assignable to parameter of type 'QueryMetrics' with 'exactOptionalPropertyTypes: true'. Consider adding 'undefined' to the types of the target's properties.
  Types of property 'error' are incompatible.
    Type 'Error | undefined' is not assignable to type 'Error'.
      Type 'undefined' is not assignable to type 'Error'.
server/db/pg-circuit.ts(159,30): error TS2344: Type 'T' does not satisfy the constraint 'QueryResultRow'.
server/db/pg-circuit.ts(185,32): error TS2538: Type 'undefined' cannot be used as an index type.
server/db/redis-circuit.ts(99,25): error TS2345: Argument of type 'string | undefined' is not assignable to parameter of type 'string'.
  Type 'undefined' is not assignable to type 'string'.
server/db/redis-circuit.ts(103,28): error TS2379: Argument of type '{ value: any; expiry: number | undefined; }' is not assignable to parameter of type '{ value: any; expiry?: number; }' with 'exactOptionalPropertyTypes: true'. Consider adding 'undefined' to the types of the target's properties.
  Types of property 'expiry' are incompatible.
    Type 'number | undefined' is not assignable to type 'number'.
      Type 'undefined' is not assignable to type 'number'.
server/db/redis-circuit.ts(234,19): error TS2379: Argument of type '{ operation: string; key: string; duration: number; hit: boolean; error: Error | undefined; fallback: boolean; }' is not assignable to parameter of type 'CacheMetrics' with 'exactOptionalPropertyTypes: true'. Consider adding 'undefined' to the types of the target's properties.
  Types of property 'error' are incompatible.
    Type 'Error | undefined' is not assignable to type 'Error'.
      Type 'undefined' is not assignable to type 'Error'.
server/db/redis-circuit.ts(291,19): error TS2379: Argument of type '{ operation: string; key: string; duration: number; hit: true; error: Error | undefined; fallback: boolean; }' is not assignable to parameter of type 'CacheMetrics' with 'exactOptionalPropertyTypes: true'. Consider adding 'undefined' to the types of the target's properties.
  Types of property 'error' are incompatible.
    Type 'Error | undefined' is not assignable to type 'Error'.
      Type 'undefined' is not assignable to type 'Error'.
server/db/redis-circuit.ts(330,19): error TS2379: Argument of type '{ operation: string; key: string; duration: number; hit: false; error: Error | undefined; }' is not assignable to parameter of type 'CacheMetrics' with 'exactOptionalPropertyTypes: true'. Consider adding 'undefined' to the types of the target's properties.
  Types of property 'error' are incompatible.
    Type 'Error | undefined' is not assignable to type 'Error'.
      Type 'undefined' is not assignable to type 'Error'.
server/db/redis-factory.ts(274,5): error TS2375: Type '{ sentinels: SentinelAddress[]; name: string | undefined; }' is not assignable to type '{ sentinels?: SentinelAddress[]; name?: string; }' with 'exactOptionalPropertyTypes: true'. Consider adding 'undefined' to the types of the target's properties.
  Types of property 'name' are incompatible.
    Type 'string | undefined' is not assignable to type 'string'.
      Type 'undefined' is not assignable to type 'string'.
server/db/redis-factory.ts(285,7): error TS2375: Type '{ sentinels: SentinelAddress[]; name: string | undefined; }' is not assignable to type '{ sentinels?: SentinelAddress[]; name?: string; }' with 'exactOptionalPropertyTypes: true'. Consider adding 'undefined' to the types of the target's properties.
  Types of property 'name' are incompatible.
    Type 'string | undefined' is not assignable to type 'string'.
      Type 'undefined' is not assignable to type 'string'.
server/db/redis-factory.ts(354,31): error TS2345: Argument of type 'string | undefined' is not assignable to parameter of type 'string'.
  Type 'undefined' is not assignable to type 'string'.
server/examples/streaming-monte-carlo-examples.ts(146,27): error TS2532: Object is possibly 'undefined'.
server/examples/streaming-monte-carlo-examples.ts(499,33): error TS2345: Argument of type 'number | undefined' is not assignable to parameter of type 'number'.
  Type 'undefined' is not assignable to type 'number'.
server/examples/streaming-monte-carlo-examples.ts(502,104): error TS2532: Object is possibly 'undefined'.
server/infra/circuit-breaker-cache.ts(40,17): error TS2322: Type '<T>(key: string) => Promise<T | undefined>' is not assignable to type '<K = string>(key: string) => Promise<K | null>'.
  Type 'Promise<K | null | undefined>' is not assignable to type 'Promise<K | null>'.
    Type 'K | null | undefined' is not assignable to type 'K | null'.
      Type 'undefined' is not assignable to type 'K | null'.
server/infra/circuit-breaker-cache.ts(122,9): error TS2416: Property 'get' in type 'CircuitBreakerCache' is not assignable to the same property in base type 'Cache<string>'.
  Type '<T>(key: string) => Promise<T | undefined>' is not assignable to type '<K = string>(key: string) => Promise<K | null>'.
    Type 'Promise<K | null | undefined>' is not assignable to type 'Promise<K | null>'.
      Type 'K | null | undefined' is not assignable to type 'K | null'.
        Type 'undefined' is not assignable to type 'K | null'.
server/infra/circuit-breaker-cache.ts(135,9): error TS2322: Type 'T | null' is not assignable to type 'T | undefined'.
  Type 'null' is not assignable to type 'T | undefined'.
server/infra/circuit-breaker-cache.ts(149,9): error TS2322: Type 'Awaited<T> | null' is not assignable to type 'T | undefined'.
  Type 'null' is not assignable to type 'T | undefined'.
server/infra/circuit-breaker-cache.ts(154,9): error TS2322: Type 'T | null' is not assignable to type 'T | undefined'.
  Type 'null' is not assignable to type 'T | undefined'.
server/infra/circuit-breaker-cache.ts(162,7): error TS2322: Type 'T | null' is not assignable to type 'T | undefined'.
  Type 'null' is not assignable to type 'T | undefined'.
server/infra/circuit-breaker-cache.ts(171,7): error TS2322: Type 'Awaited<T> | null' is not assignable to type 'T | undefined'.
  Type 'null' is not assignable to type 'T | undefined'.
server/infra/circuit-breaker-cache.ts(176,7): error TS2322: Type 'T | null' is not assignable to type 'T | undefined'.
  Type 'null' is not assignable to type 'T | undefined'.
server/infra/circuit-breaker/CircuitBreaker.ts(128,42): error TS2532: Object is possibly 'undefined'.
server/lib/auth/jwt.ts(60,50): error TS4111: Property 'sendStatus' comes from an index signature, so it must be accessed with ['sendStatus'].
server/lib/flags.ts(125,22): error TS18048: 'flag.targeting.rules' is possibly 'undefined'.
