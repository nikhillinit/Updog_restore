# Environment Variables Configuration
# Copy to .env and update values for your environment

# Database (required for production)
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/povc_dev

# Redis (optional - for background jobs and caching)
REDIS_URL=redis://localhost:6379

# Node environment
NODE_ENV=development

# Server configuration
PORT=5000
SESSION_SECRET=change-me-in-production-to-random-string

# Request body limits (default: 1mb)
# BODY_LIMIT=1mb

# Trust proxy configuration (important for production)
# Local/dev: loopback, linklocal, uniquelocal (default)
# Behind single proxy: 1
# Behind known CIDR: 10.0.0.0/8, 172.16.0.0/12
# TRUST_PROXY=loopback, linklocal, uniquelocal

# CORS configuration (comma-separated origins)
# CORS_ORIGIN=http://localhost:5173,http://localhost:5000

# API origin for CSP connect-src directive
# API_ORIGIN=http://localhost:5000

# Health endpoint protection (optional)
# HEALTH_KEY=your-secret-key-here

# Shutdown configuration
# SHUTDOWN_RETRY_AFTER_SECONDS=30

# Rate limiting (optional - for cluster deployments)
# RATE_LIMIT_REDIS_URL=redis://localhost:6379

# Idempotency configuration
IDEMPOTENCY_MAX=5000
IDEMPOTENCY_TTL=86400

# Monitoring (optional)
# SENTRY_DSN=https://your-sentry-dsn
# PROMETHEUS_PORT=9090

# Feature flags
ENABLE_WEBSOCKETS=false
ENABLE_WORKERS=false

# Circuit Breaker Configuration (start with flags disabled for shadow mode)
# Cache circuit breaker (Redis protection)
CB_CACHE_ENABLED=false
CB_CACHE_FAILURE_THRESHOLD=5
CB_CACHE_RESET_TIMEOUT_MS=30000
CB_CACHE_OP_TIMEOUT_MS=2000
CB_CACHE_SUCCESS_TO_CLOSE=3
CB_CACHE_HALF_OPEN_MAX_CONC=2

# HTTP circuit breaker (external APIs)
CB_HTTP_ENABLED=false
CB_HTTP_FAILURE_THRESHOLD=3
CB_HTTP_RESET_TIMEOUT_MS=60000
CB_HTTP_OP_TIMEOUT_MS=5000
CB_HTTP_SUCCESS_TO_CLOSE=2
CB_HTTP_HALF_OPEN_MAX_CONC=1

# Database circuit breaker (keep disabled initially)
CB_DB_ENABLED=false
CB_DB_FAILURE_THRESHOLD=3
CB_DB_RESET_TIMEOUT_MS=30000
CB_DB_OP_TIMEOUT_MS=10000
CB_DB_SUCCESS_TO_CLOSE=2
CB_DB_HALF_OPEN_MAX_CONC=1

# External services (optional)
# NATS_URL=nats://localhost:4222
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/...

# Development overrides
# VITE_API_URL=http://localhost:5000
# READYZ_STRICT=false